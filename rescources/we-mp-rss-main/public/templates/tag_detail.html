{% include "includes/header.html" %}

{% block title %}WeRSS - {{tag.name}}æ ‡ç­¾è¯¦æƒ…{% endblock %}

{% include "includes/tag_style.html" %}
{% if not error %}
<!-- é¢åŒ…å±‘å¯¼èˆª -->
<div class="breadcrumb">
    {% for item in breadcrumb %}
        {% if item.url %}
            <a href="{{item.url}}">{{item.name}}</a>
        {% else %}
            <span style="color: #6c757d;">{{item.name}}</span>
        {% endif %}
        {% if not loop.last %} / {% endif %}
    {% endfor %}
</div>

<!-- æ ‡ç­¾ä¿¡æ¯å¤´éƒ¨ -->
<div class="card">
    <div class="tag-header">
        {% if tag.cover %}
        <img src="{{tag.cover}}" alt="{{tag.name}}" class="tag-cover">
        {% else %}
        <div class="tag-cover" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">ğŸ“š</div>
        {% endif %}
        <div class="tag-info">
            <h1>{{tag.name}}</h1>
            <p class="text-muted">{{tag.intro or "æš‚æ— ç®€ä»‹"}}</p>
            <div class="tag-stats">
                <span class="stat-item">ğŸ“º {{tag.mp_count}} ä¸ªå…¬ä¼—å·</span>
                <span class="stat-item">ğŸ“„ {{tag.article_count}} ç¯‡æ–‡ç« </span>
            </div>
        </div>
    </div>
</div>

<!-- æ–‡ç« åˆ—è¡¨ -->
{% if articles %}
<div class="card">
    <h2>ğŸ“„ æœ€æ–°æ–‡ç« </h2>
    
    {% for article in articles %}
    <div class="article-item">
        <div class="article-title">
            <a href="{{article.url}}" target="_blank">{{article.title}}</a>
        </div>
        {% if article.description %}
        <p class="text-muted">{{article.description[:150]}}{% if article.description|length > 150 %}...{% endif %}</p>
        {% endif %}
        <div class="article-meta">
            ğŸ“º {{article.mp_name}} | ğŸ•’ {{article.publish_time}}
        </div>
    </div>
    {% endfor %}

    <!-- åˆ†é¡µ -->
    {% set base_url = "/views/tag/" ~ tag.id %}
    {% set item_name = "ç¯‡æ–‡ç« " %}
    {% include "includes/pagination.html" with context %}
</div>

{% else %}
{% include "includes/empty_state.html" with context %}
{% set icon = 'ğŸ“­' %}
{% set title = 'æš‚æ— æ–‡ç« ' %}
{% set description = 'è¯¥æ ‡ç­¾ä¸‹è¿˜æ²¡æœ‰æ–‡ç« ' %}
{% endif %}
{% endif %}

{% include "includes/footer.html" %}